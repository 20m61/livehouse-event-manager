# Livehouse Event Manager 要件定義

**バージョン:** 1.0  
**作成日:** 2025 年 4 月 15 日  
**最終更新日:** 2025 年 4 月 15 日

## 1. カスタム投稿タイプ

- 投稿タイプ: `live_event`
- 表示ラベル: イベント（Singular & Plural）
- 管理画面メニューに「Livehouse Events」として追加
- 権限: 管理者のみ操作可能
- サポート機能: タイトル、本文、アイキャッチ画像
- show_in_rest: REST API 対応

## 2. カスタムタクソノミー

- タクソノミー: `event_genre`
- 表示ラベル: ジャンル
- 階層なし（タグ形式）
- イベント投稿画面でドロップダウン選択
- show_in_rest: REST API 対応

## 3. メタボックス（イベント情報）

- 開催日 (`date`)
- 開場時間 (`time`)
- 開演時間 (`time`)
- 出演者 (`text`)
- チケット料金 (`text`)
- チケット URL (`url`)
- 配信情報 (`text`)
- ジャンルは上記タクソノミーを利用

## 4. 保存・表示

- 下書き、公開、更新、ゴミ箱対応
- 投稿保存時にメタフィールドとタクソノミーを保存
- 管理画面一覧に「開催日」「開演時間」「出演者」カラムを追加

## 5. フロントエンド出力

- ショートコード `[live_events]` を提供
  - 属性: `number` (表示件数)、`genre` (スラッグ指定)、`upcoming` (未来イベントのみ)
- アーカイブ/シングル用テンプレートをプラグイン内で読み込み
- `/assets/js/wlem-ajax.js` に共通 Ajax モジュールを実装

## 6. 国際化 (i18n)

- 全テキストを `__()` / `_e()` でラップ
- テキストドメイン: `wp-livehouse-event-manager`
- `/languages` 配下に `.pot` ファイルを配置

## 7. アンインストール

- 投稿タイプ `live_event` の全投稿を完全削除
- タクソノミー `event_genre` の全タームを削除
- 必要に応じてオプションを削除
  - `delete_option()` によるオプション削除対応
  - `delete_option('wlem_options')` によるオプション削除対応

## 8. テスト

- PHPUnit による単体テストを構築
  - カスタム投稿/タクソノミーの REST 対応
  - AJAX フィルタエンドポイント
  - ショートコード＆テンプレート読み込み
  - CPT／タクソノミーの REST 対応検証
  - AJAX フィルタエンドポイント検証
  - ショートコード出力検証
  - テンプレート読み込み上書き検証
